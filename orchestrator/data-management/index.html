<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  
  
  <title>Orchestrator Data Management - DETERLab Docs</title>
  

  <link rel="shortcut icon" href="../../favicon.ico">
  

  
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  <link rel="stylesheet" href="../../css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../css/theme_extra.css" type="text/css" />
  <link rel="stylesheet" href="../../css/highlight.css">
  <link href="../../css/extra.css" rel="stylesheet">

  
  <script>
    // Current page data
    var mkdocs_page_name = "Orchestrator Data Management";
    var mkdocs_page_input_path = "orchestrator/data-management.md";
    var mkdocs_page_url = "/orchestrator/data-management/";
  </script>
  
  <script src="../../js/jquery-2.1.1.min.js"></script>
  <script src="../../js/modernizr-2.8.3.min.js"></script>
  <script type="text/javascript" src="../../js/highlight.pack.js"></script>
  <script src="../../js/theme.js"></script> 

  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    

    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
      <div class="wy-side-nav-search">
        <a href="../.." class="icon">
          <!--REPLACE LOGO FILE HERE -->
          <img class="logo" style="float:left" src="/img/doc-logo.png"/> 
          <span class="title">DETERLab Docs</span></a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        <ul class="current">
          
            <li>
    <li class="toctree-l1 ">
        <a class="" href="../..">Welcome to the DETERLab Documentation</a>
        
    </li>
<li>
          
            <li>
    <li class="toctree-l1 ">
        <a class="" href="../../Glossary/">Glossary</a>
        
    </li>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>DETERLab Core</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../core/core-quickstart/">Core Quickstart</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../core/core-guide/">Core Guide</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../core/sample-topologies/">Sample Topologies</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../core/using-nodes/">Using Your Nodes</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../core/generating-traffic/">Generating Traffic</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../core/link-delays/">End Node Traffic Shaping</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../core/sharing/">Using Shared Materials</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../core/user-guidelines/">User Do's and Don'ts</a>
        
    </li>

        
    </ul>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>Core Reference</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../core/deterlab-commands/">DETERLab Commands</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../core/ns-commands/">NS Commands Extensions</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../core/swapping/">Understanding Swapping (Node Use Policies)</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../core/DETERSSH/">Accessing testbeds using SSH</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../core/node-types/">DETERLab Node Types</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../core/serial-console/">Using the Serial Console</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../core/dell-serial-console/">Dell Serial Console</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../core/os-images/">OS Images</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../core/custom-images/">Creating Custom Images</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../core/windows/">Windows XP</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../core/legacy-tools/">Legacy Tools</a>
        
    </li>

        
    </ul>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>Orchestrator</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../orchestrator-quickstart/">Orchestrator Quickstart</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../orchestrator-guide/">Orchestrator Guide</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../orchestrator-case-studies/">Orchestrator Case Studies</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../simple-client-server/">Simple Client Server Case Study</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../scaled-client-server/">Scaled Client Server Case Study</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../feedback/">Feedback Case Study</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../writing-agents/">Specialized User</a>
        
    </li>

        
            
    <li class="toctree-l1 current">
        <a class="current" href="./">Orchestrator Data Management</a>
        
            <ul>
            
                <li class="toctree-l3"><a href="#data-manager-configuration">Data Manager Configuration</a></li>
                
                    <li><a class="toctree-l4" href="#sense-and-collect">Sense and Collect</a></li>
                
                    <li><a class="toctree-l4" href="#query-and-analyze">Query and Analyze</a></li>
                
            
            </ul>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../orchestrator-config/">MAGI Configuration</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../orchestrator-reference/">Orchestrator Reference</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../system-files/">MAGI System Organization</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../agent-library/">MAGI Agent Library</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../magi-tools/">MAGI Tools</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../magi-dev/">MAGI Development Codebase</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../magi-desktop/">MAGI Desktop</a>
        
    </li>

        
    </ul>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>Containers</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../containers/containers-quickstart/">Containers Quickstart</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../containers/containers-guide/">Containers Guide</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../containers/containers-reference/">Containers Reference</a>
        
    </li>

        
    </ul>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>Other Features</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../federation/">Federation</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../abac/">ABAC</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../competitions/">Competitions</a>
        
    </li>

        
    </ul>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>Education Materials</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../education/">Education Materials Overview</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../education/guidelines-for-teachers/">Guidelines for Teachers</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../education/class-support/">Class Support</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../education/course-setup/">Course Setup</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../education/good-teaching-practices/">Good Teaching Practices</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../education/connect-with-teachers/">Connect With Other Teachers</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../education/guidelines-for-students/">Guidelines for Students</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../education/student-intro/">Student Introduction to DETERLab</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../education/public-materials/">Public Materials</a>
        
    </li>

        
    </ul>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>Miscellaneous</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../ISIUCB/">DETERLab Rooms</a>
        
    </li>

        
    </ul>
<li>
          
        </ul>
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../..">DETERLab Docs</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../..">Docs</a> &raquo;</li>
    
      
        
          <li>Orchestrator &raquo;</li>
        
      
    
    <li>Orchestrator Data Management</li>
    <li class="wy-breadcrumbs-aside">
      
    </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <p>Data Management is a very important aspect of experimentation, which is why the data management layer is a very important aspect of the Orchestrator's framework.</p>
<p>The following are some of the important terms that are used in context of Orchestrator's data management layer.</p>
<ul>
<li><strong>Sensor</strong>: Orchestrator agent that senses information and needs to store it.</li>
<li><strong>Collector</strong>: Database server that can be used to store data.</li>
<li><strong>Shard</strong>: In case of a distributed database setup, the data is partitioned and stored in multiple database servers. This concept of partitioning data is known as "sharding", and each of the database servers is known as a "shard".</li>
</ul>
<p>Orchestrator's data management layer is highly configurable, with experimenters having the ability to setup a centralized or a distributed database, and also configure, at the node level, where sensors collect data.</p>
<p>In case of a distributed/shared database setup, Orchestrator sets up a global database server. This server gives a holistic view of the database.</p>
<p>Orchestrator data management uses <a href="http://www.mongodb.org">MongoDB</a> at its base.</p>
<h2 id="data-manager-configuration">Data Manager Configuration<a class="headerlink" href="#data-manager-configuration" title="Permanent link"></a></h2>
<p>The data management layer configuration is part of the Orchestrator’s experiment level and node level configuration files.</p>
<p>As mentioned earlier, Orchestrator’s data management layer is highly configurable. More information about the same in available at <a href="/orchestrator/orchestrator-config/#dbdl-configure-the-magi-data-management-layer">DBDL: Configure the Orchestrator Data Management Layer</a>.</p>
<p>Orchestrator’s data management layer enables an experimenter to do the following.</p>
<h3 id="sense-and-collect">Sense and Collect<a class="headerlink" href="#sense-and-collect" title="Permanent link"></a></h3>
<p>The following are the steps an agent developer should follow to populate Orchestrator’s database</p>
<ol>
<li>Import the database management utility</li>
</ol>
<pre><code>    from magi.util import database
</code></pre>

<ol>
<li>Initialize a database collection passing it a unique name. We suggest using the agent name. Each agent implementation that extends from one of the predefined agents, like the DispatchAgent, has a variable “name” that stores the agent name.</li>
</ol>
<pre><code>    self.collection = database.getCollection(self.name)
</code></pre>

<ol>
<li>Insert data. Each record can be inserted as a dictionary of key-value pairs.</li>
</ol>
<pre><code>    self.collection.insert({“key1” : “value1”, “key2”: “value2”})
</code></pre>

<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The db management utility inserts three other entries per record:</p>
<ul>
<li>
<p>host: <code>&lt;node’s hostname&gt;</code></p>
</li>
<li>
<p>created: <code>&lt;record creation time&gt;</code></p>
</li>
<li>
<p>agent: <code>&lt;agent name&gt;</code></p>
</li>
</ul>
</div>
<h3 id="query-and-analyze">Query and Analyze<a class="headerlink" href="#query-and-analyze" title="Permanent link"></a></h3>
<p>In case of a distributed database setup, a user can connect to the mongo db server running on the global server node to get an experiment-wide view.</p>
<p>However, in case of an unsharded setup, a user would have to connect to the appropriate collector based on the sensor-collector mapping to fetch data stored by a particular sensor.</p>
<p>Orchestrator, by default, sets up an non-distributed database, with all the sensors collecting at the same collector.</p>
<pre><code>&gt; mongo node-1.myExperiment.myProject:27018
mongo&gt; use magi
switched to db magi
mongo&gt; db.experiment_data.find()
{ "agent" : "user_agent", "host" : "node-1", "created" : 1409075736.646182,
"key1" : "value1", "key2" : "value2" }
{ "agent" : "user_agent", "host" : "node-2", "created" : 1409075737.514683,
"key3" : "value3", "key4" : "value4" }
In case of a distributed setup, the configuration file would have information about a global server host. An experimenter can connect to the global server to get an experiment wide view of the database, or connect to individual collectors to get their local view.
</code></pre>
<p>And, for more advanced queries, you can refer the Mongo documentation available at <a href="http://docs.mongodb.org/manual/tutorial/query-documents/">http://docs.mongodb.org/manual/tutorial/query-documents/</a>.</p>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../orchestrator-config/" class="btn btn-neutral float-right" title="MAGI Configuration">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../writing-agents/" class="btn btn-neutral" title="Specialized User"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
      <p>Copyright &copy; 2016 <a href="https://www.deter-project.org/">DETER Project</a>.</p>
    
  </div>

  Built with <a href="http://www.mkdocs.org">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
	  
        </div>
      </div>

    </section>

  </div>

<div class="rst-versions" role="note" style="cursor: pointer">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
      
        <span><a href="../writing-agents/" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../orchestrator-config/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>
  <!-- this makes the active part of the navigation sidebar scroll to top -->
<script type="text/javascript">
$(document).ready(function () {

  if ($("a").hasClass("current")) {
    var container = $("nav"),
    scrollTo = $("a.current");

    container.scrollTop(
    scrollTo.offset().top - container.offset().top + container.scrollTop() - 120
    );
    
    }
});
</script>
</body>
</html>
